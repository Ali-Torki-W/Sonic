/* src/app/features/feed/pages/feed-page/feed-page.scss */
/* Ethereal “glass + card” style driven by CSS tokens (light/dark handled globally).
   No horizontal scrolling, strong mobile layout, soft borders + big radii. */

:host {
    display: block;
    color: var(--foreground, #111);
}

/* Page container */
.feed {
    width: 100%;
    max-width: 56rem;
    /* matches the “max-w-2xl-ish” vibe */
    margin: 0 auto;
    padding: 1.25rem 0;
    display: grid;
    gap: 1rem;

    /* prevent accidental sideways scroll on small devices */
    overflow-x: clip;
}

/* Header “card” */
.feed__header {
    border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
    border-radius: 1.25rem;
    padding: 1.25rem;
    background: color-mix(in oklab, var(--card, #fff) 78%, transparent);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);

    box-shadow:
        0 10px 30px color-mix(in oklab, var(--primary, #6d5efc) 8%, transparent),
        0 2px 10px color-mix(in oklab, #000 10%, transparent);

    h1 {
        margin: 0 0 0.75rem 0;
        font-size: 1.35rem;
        font-weight: 600;
        letter-spacing: -0.02em;
    }
}

/* Common control styling */
.feed__filters,
.feed__types,
.feed__tags {
    width: 100%;
}

.feed__filters {
    display: grid;
    gap: 0.75rem;
    align-items: center;
    margin-top: 0.5rem;

    /* Desktop layout: search grows, buttons to the right */
    @media (min-width: 768px) {
        grid-template-columns: 1fr auto auto;
    }

    input {
        width: 100%;
        min-width: 0;
        height: 2.75rem;
        padding: 0 1rem;
        border-radius: 1rem;

        border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
        background: color-mix(in oklab, var(--muted, #f2f2f4) 60%, transparent);
        color: var(--foreground, #111);

        outline: none;
        transition: border-color 180ms ease, background-color 180ms ease, box-shadow 180ms ease;

        &::placeholder {
            color: color-mix(in oklab, var(--muted-foreground, #666) 70%, transparent);
        }

        &:focus {
            border-color: color-mix(in oklab, var(--primary, #6d5efc) 45%, var(--border, #ccc));
            background: var(--card, #fff);
            box-shadow: 0 0 0 4px color-mix(in oklab, var(--primary, #6d5efc) 18%, transparent);
        }
    }

    button {
        height: 2.75rem;
        padding: 0 0.95rem;
        border-radius: 999px;
        border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
        background: color-mix(in oklab, var(--muted, #f2f2f4) 45%, transparent);
        color: color-mix(in oklab, var(--foreground, #111) 82%, transparent);

        font-weight: 600;
        font-size: 0.9rem;

        cursor: pointer;
        user-select: none;
        transition: transform 120ms ease, background-color 180ms ease, border-color 180ms ease, box-shadow 180ms ease;

        &:hover {
            background: color-mix(in oklab, var(--muted, #f2f2f4) 70%, transparent);
            border-color: color-mix(in oklab, var(--border, #ccc) 70%, var(--primary, #6d5efc));
        }

        &:active {
            transform: translateY(1px);
        }

        &:disabled {
            opacity: 0.55;
            cursor: not-allowed;
            transform: none;
        }
    }
}

/* Type “pill” row */
.feed__types {
    margin-top: 0.85rem;
    display: flex;
    gap: 0.5rem;
    align-items: center;

    /* horizontal scroll on tiny phones, without causing page overflow */
    overflow-x: auto;
    overscroll-behavior-x: contain;
    padding-bottom: 0.25rem;

    /* hide scrollbar (non-critical) */
    scrollbar-width: none;

    &::-webkit-scrollbar {
        width: 0;
        height: 0;
    }

    button {
        flex: 0 0 auto;
        height: 2.25rem;
        padding: 0 0.9rem;
        border-radius: 999px;

        border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
        background: color-mix(in oklab, var(--muted, #f2f2f4) 40%, transparent);
        color: color-mix(in oklab, var(--muted-foreground, #666) 92%, transparent);

        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;

        transition: background-color 180ms ease, border-color 180ms ease, color 180ms ease, box-shadow 180ms ease;

        &:hover {
            background: color-mix(in oklab, var(--muted, #f2f2f4) 60%, transparent);
            color: var(--foreground, #111);
        }

        /* NOTE: “selected” styling requires a class/aria state.
       If you add [class.active]="selectedType()===t" later, this will kick in. */
        &.active {
            background: color-mix(in oklab, var(--primary, #6d5efc) 16%, transparent);
            border-color: color-mix(in oklab, var(--primary, #6d5efc) 40%, var(--border, #ccc));
            color: var(--foreground, #111);
            box-shadow: 0 8px 18px color-mix(in oklab, var(--primary, #6d5efc) 12%, transparent);
        }
    }
}

/* Tags area */
.feed__tags {
    margin-top: 0.9rem;
    display: grid;
    gap: 0.75rem;

    /* input + add button */
    >input,
    >button {
        /* avoid accidental full-width overflow */
        min-width: 0;
    }

    /* Make the first row look like a compact control group */
    >input {
        width: 100%;
        height: 2.6rem;
        padding: 0 1rem;
        border-radius: 1rem;

        border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
        background: color-mix(in oklab, var(--muted, #f2f2f4) 55%, transparent);
        color: var(--foreground, #111);

        outline: none;
        transition: border-color 180ms ease, background-color 180ms ease, box-shadow 180ms ease;

        &::placeholder {
            color: color-mix(in oklab, var(--muted-foreground, #666) 70%, transparent);
        }

        &:focus {
            border-color: color-mix(in oklab, var(--primary, #6d5efc) 45%, var(--border, #ccc));
            background: var(--card, #fff);
            box-shadow: 0 0 0 4px color-mix(in oklab, var(--primary, #6d5efc) 18%, transparent);
        }
    }

    >button {
        width: fit-content;
        height: 2.6rem;
        padding: 0 1rem;
        border-radius: 999px;

        border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
        background: color-mix(in oklab, var(--primary, #6d5efc) 90%, transparent);
        color: var(--primary-foreground, #fff);

        font-weight: 700;
        cursor: pointer;
        transition: transform 120ms ease, filter 180ms ease, box-shadow 180ms ease;

        &:hover {
            filter: brightness(1.03);
            box-shadow: 0 14px 28px color-mix(in oklab, var(--primary, #6d5efc) 16%, transparent);
        }

        &:active {
            transform: translateY(1px);
        }
    }

    /* On desktop, align input and button on one row */
    @media (min-width: 768px) {
        grid-template-columns: 1fr auto;
        align-items: center;
    }
}

.feed__taglist {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: center;

    button {
        border: 1px solid color-mix(in oklab, var(--primary, #6d5efc) 25%, var(--border, #ccc));
        background: color-mix(in oklab, var(--primary, #6d5efc) 10%, transparent);
        color: color-mix(in oklab, var(--primary, #6d5efc) 82%, var(--foreground, #111));

        padding: 0.4rem 0.7rem;
        border-radius: 999px;
        font-size: 0.85rem;
        font-weight: 700;

        cursor: pointer;
        transition: background-color 180ms ease, border-color 180ms ease, transform 120ms ease;

        &:hover {
            background: color-mix(in oklab, var(--primary, #6d5efc) 16%, transparent);
            border-color: color-mix(in oklab, var(--primary, #6d5efc) 40%, var(--border, #ccc));
        }

        &:active {
            transform: translateY(1px);
        }
    }
}

/* Error box */
.feed__error {
    border: 1px solid color-mix(in oklab, var(--destructive, #d32f2f) 45%, var(--border, #ccc));
    background: color-mix(in oklab, var(--destructive, #d32f2f) 10%, transparent);
    border-radius: 1.25rem;
    padding: 1rem 1.1rem;

    p {
        margin: 0.15rem 0;
    }

    small {
        color: color-mix(in oklab, var(--muted-foreground, #666) 85%, transparent);
    }
}

/* List layout */
.feed__list {
    display: grid;
    gap: 0.9rem;
}

/* Post card */
.post {
    border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
    border-radius: 1.25rem;
    padding: 1.1rem 1.1rem;
    background: var(--card, #fff);

    box-shadow:
        0 12px 28px color-mix(in oklab, #000 8%, transparent),
        0 2px 10px color-mix(in oklab, var(--primary, #6d5efc) 6%, transparent);

    transition: transform 160ms ease, box-shadow 220ms ease, border-color 220ms ease;

    &:hover {
        transform: translateY(-1px);
        border-color: color-mix(in oklab, var(--primary, #6d5efc) 30%, var(--border, #ccc));
        box-shadow:
            0 18px 40px color-mix(in oklab, #000 10%, transparent),
            0 10px 28px color-mix(in oklab, var(--primary, #6d5efc) 10%, transparent);
    }

    h3 {
        margin: 0 0 0.5rem 0;
        font-size: 1.05rem;
        font-weight: 700;
        letter-spacing: -0.01em;

        a {
            color: var(--foreground, #111);
            text-decoration: none;

            &:hover {
                color: color-mix(in oklab, var(--primary, #6d5efc) 85%, var(--foreground, #111));
            }
        }
    }
}

.post__meta {
    margin: 0 0 0.7rem 0;
    font-size: 0.85rem;
    color: color-mix(in oklab, var(--muted-foreground, #666) 92%, transparent);

    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem 0.5rem;

    span {
        white-space: nowrap;
    }
}

.post__body {
    margin: 0;
    color: color-mix(in oklab, var(--foreground, #111) 92%, transparent);
    line-height: 1.55;
    font-size: 0.95rem;

    /* clamp long bodies */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 5;
    overflow: hidden;
}

.post__tags {
    margin: 0.8rem 0 0 0;
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem 0.5rem;

    span {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;

        padding: 0.25rem 0.55rem;
        border-radius: 999px;

        background: color-mix(in oklab, var(--primary, #6d5efc) 8%, transparent);
        color: color-mix(in oklab, var(--primary, #6d5efc) 80%, var(--foreground, #111));
        font-size: 0.8rem;
        font-weight: 700;

        border: 1px solid color-mix(in oklab, var(--primary, #6d5efc) 18%, var(--border, #ccc));
    }
}

.post__stats {
    margin: 0.9rem 0 0 0;
    font-size: 0.85rem;
    color: color-mix(in oklab, var(--muted-foreground, #666) 95%, transparent);
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem 0.5rem;
}

/* Load more button: looks like a “cta outline pill” */
.feed>button[type='button'] {
    justify-self: center;
    height: 2.75rem;
    padding: 0 1.15rem;
    border-radius: 999px;

    border: 1px solid var(--border, rgba(0, 0, 0, 0.12));
    background: transparent;
    color: var(--foreground, #111);

    font-weight: 700;
    cursor: pointer;

    transition: background-color 180ms ease, border-color 180ms ease, box-shadow 180ms ease, transform 120ms ease;

    &:hover {
        background: color-mix(in oklab, var(--muted, #f2f2f4) 55%, transparent);
        border-color: color-mix(in oklab, var(--primary, #6d5efc) 25%, var(--border, #ccc));
        box-shadow: 0 14px 28px color-mix(in oklab, var(--primary, #6d5efc) 10%, transparent);
    }

    &:active {
        transform: translateY(1px);
    }

    &:disabled {
        opacity: 0.55;
        cursor: not-allowed;
        transform: none;
    }
}

/* Mobile tightening (no ugly cramped layout) */
@media (max-width: 480px) {
    .feed {
        padding: 0.75rem 0;
    }

    .feed__header {
        padding: 1rem;
        border-radius: 1.1rem;
    }

    .post {
        padding: 1rem;
        border-radius: 1.1rem;
    }

    .feed__filters button {
        width: 100%;
    }

    .feed__tags {
        grid-template-columns: 1fr;

        >button {
            width: 100%;
        }
    }
}